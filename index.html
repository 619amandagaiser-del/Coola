<!DOCTYPE html>
<html>
<head>
    <title>Titan Hub</title>
    <style>
        body { background: #0b0e14; color: #c9d1d9; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        nav { background: #161b22; padding: 10px 20px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #30363d; }
        input { flex: 1; padding: 8px; border-radius: 4px; border: 1px solid #30363d; background: #0d1117; color: white; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding: 20px; overflow-y: auto; }
        .card { background: #161b22; border: 1px solid #30363d; padding: 15px; border-radius: 8px; text-align: center; cursor: pointer; }
        .card:hover { border-color: #58a6ff; }
        iframe { flex: 1; border: none; display: none; background: white; }
    </style>
</head>
<body>
    <nav>
        <div onclick="location.reload()" style="cursor:pointer; font-weight:bold; color:#58a6ff;">TITAN</div>
        <input type="text" id="url" placeholder="Enter URL or search games...">
        <button onclick="launch()">Go</button>
    </nav>
    <div id="game-grid" class="grid">Loading Games...</div>
    <iframe id="view"></iframe>

    <script>
        const MONKEY_REPO = "https://raw.githubusercontent.com/MonkeyGG2/monkeygg2.github.io/main";

        async function loadGames() {
            const res = await fetch(`${MONKEY_REPO}/config.jsonc`);
            const text = await res.text();
            const data = JSON.parse(text.replace(/\/\/.*|\/\*[\s\S]*?\*\//g, ""));
            
            const grid = document.getElementById('game-grid');
            grid.innerHTML = "";
            Object.keys(data.games).forEach(name => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `ðŸŽ®<br><b>${name}</b>`;
                div.onclick = () => openGame(`${MONKEY_REPO}/games/${data.games[name].path}`);
                grid.appendChild(div);
            });
        }

        function openGame(url) {
            document.getElementById('game-grid').style.display = 'none';
            const frame = document.getElementById('view');
            frame.style.display = 'block';
            // Route through your internal proxy to bypass CORS
            frame.src = `/p?url=${encodeURIComponent(url)}`;
        }

        function launch() {
            const val = document.getElementById('url').value;
            if (val) openGame(val.startsWith('http') ? val : 'https://' + val);
        }

        loadGames();
    </script>
</body>
</html>
